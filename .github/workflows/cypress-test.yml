name: 'E2E Tests'
on:
  workflow_dispatch:
  push:
jobs:
  run-e2e-tests:
    name: 'E2E Tests'
    runs-on: ubuntu-latest
    timeout-minutes: 35
    container:
      image: cypress/included:10.4.0
    steps:
      - name: 'Checkout'
        uses: actions/checkout@master
      - name: Yarn Install
        run: yarn
      - name: Setup tunnel
        uses: joshlarsen/ssh-tunnel-action@main
        with:
          timeout: 1h
          ssh_public_key: ${{ secrets.SSH_PUBLIC_KEY }}
          ngrok_token: ${{ secrets.NGROK_TOKEN }}
      - name: run cypress
        run: cypress run --browser firefox